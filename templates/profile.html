<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <title>MY PROFILE</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
    <header>
        <h1>{{ user_name }}ë‹˜ì˜ <span class="highlight">PROFILE</span></h1>
    </header>
    <main>
        <section>
            <h2>ğŸŒ¸ í”„ë¡œí•„ ì •ë³´ ğŸŒ¸</h2>
            <p>ìœ ì € ì´ë¦„ : {{ user_name }}</p>
            <p>ë¦¬ë·° ì‘ì„± ê°œìˆ˜: {{ reviews|length }}</p>
        </section>
        <section>
            <section>
                <h2>ğŸ’– ì‘ì„±í•œ ë¦¬ë·° ğŸ’–</h2>
                <!-- ë¦¬ë·° ì¶”ê°€ ë²„íŠ¼ -->
                <button id="addReviewBtn">âœï¸ ë¦¬ë·° ì¶”ê°€ âœï¸</button>
                <section class="review-list">
                    {% if reviews %}
                    <table class="review-table">
                        <thead>
                            <tr>
                                <th>Movie Title</th>
                                <th>Comment</th>
                                <th>Review Date</th>
                                <th>Watched Date</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for review in reviews %}
                            <tr>
                                <td>{{ review['movie_title'] }}</td>
                                <td>{{ review['comment'] }}</td>
                                <td>{{ review['reviewDate'] }}</td>
                                <td>{{ review['watchedDate'] }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    {% else %}
                    <p class="no-reviews">ì‘ì„±í•œ ë¦¬ë·°ê°€ ì—†ìŠµë‹ˆë‹¤. ğŸ˜¢</p>
                    {% endif %}
                </section>


    </main>

    <script>
        document.getElementById("addReviewBtn").addEventListener("click", function () {
            const username = "{{ user_name }}";  // ë¶€ëª¨ ì°½ì—ì„œ ì‚¬ìš©ì ì´ë¦„ ê°€ì ¸ì˜¤ê¸°
            const popup = window.open(
                `/review/popup?username=${encodeURIComponent(username)}`,
                "ë¦¬ë·° ì¶”ê°€",
                "width=500,height=600"
            );
            if (popup) {
                popup.focus();
            } else {
                alert("íŒì—…ì„ ì—´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. íŒì—… ì°¨ë‹¨ ì„¤ì •ì„ í™•ì¸í•˜ì„¸ìš”.");
            }
        });
    </script>

</body>

</html>